---
title: 
output: html_notebook
Name: Robert Leigh
Date: 15 November 2017
File Description: This is the data wrangling part of RStudio exercise 3 in the Introduction to Open Data Science Course. 

---


student-mat.csv and student-por.csv were read into R from the data folder using the read.csv command and using the semicolon as separation. The student-mat data frame consists of 395 objects (rows/observations) and 33 variables. The student-por data frame consists of 649 objects (rows/observations) and the same 33 variables. Variables include Factors with multiple levels and integer variables. Note student-mat includes math grades and student-por includes portugues grades. 

```{r}
student_mat <- read.csv("C:/HY-Data/LEIGH/course material/introduction_to_open_data_science/IODS_project_6_nov/data/student-mat.csv", sep = ";")
student_por <- read.csv("C:/HY-Data/LEIGH/course material/introduction_to_open_data_science/IODS_project_6_nov/data/student-por.csv", sep = ";")

str(student_mat)
dim(student_mat)
str(student_por)
dim(student_por)

```

The two data sets (math and portugues) were joined using the variables "school", "sex", "age", "address", "famsize", "Pstatus", "Medu", "Fedu", "Mjob", "Fjob", "reason", "nursery","internet" as (student) identifiers. The suffixes ",por" and ".mat" were added to denote the origin of the columns. The combined dataset has 382 observations and 53 variables, though some variables are duplicated and must be removed. 

```{r}
library(dplyr)
join_by <- c("school","sex","age","address","famsize","Pstatus","Medu","Fedu","Mjob","Fjob","reason","nursery","internet")
math_por <- inner_join(student_mat, student_por, by = join_by, suffix = c(".math", ".por"))
dim(math_por)
str(math_por)

```

The duplicated answers were combined using a for loop and if/else statement as in the Datacamp exercise. 

```{r}

alc <- select(math_por, one_of(join_by))
notjoined_columns <- colnames(student_mat)[!colnames(student_mat) %in% join_by]
notjoined_columns
for(column_name in notjoined_columns) {
  two_columns <- select(math_por, starts_with(column_name))
  first_column <- select(two_columns, 1)[[1]]

  if(is.numeric(first_column)) {
    alc[column_name] <- round(rowMeans(two_columns))
  } else {
    alc[column_name] <- select(two_columns, 1)[[1]]
  }
}

str(alc)
dim(alc)

```



"alc_use" was generated by taking the average of weekday and weekend alcohol consumption. "high_use" was generated by including those greater than 2. 

```{r}

alc <- mutate(alc, alc_use = (Dalc + Walc) / 2)
alc <- mutate(alc, high_use = ifelse(alc_use > 2, TRUE, FALSE))


```


A glimpse at the data suggests all is in order, and the data was written to a file. 
```{r}

glimpse(alc)

write.csv(math_por, file = "C:/HY-Data/LEIGH/course material/introduction_to_open_data_science/IODS_project_6_nov/data/mat_por.csv", row.names = FALSE)
write.csv(alc, file = "C:/HY-Data/LEIGH/course material/introduction_to_open_data_science/IODS_project_6_nov/data/alc.csv", row.names = FALSE)

```

